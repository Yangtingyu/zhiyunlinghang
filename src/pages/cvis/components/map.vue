<template>
  <zebra-echart :option="mapOption" not-merge />
</template>

<script>
export default {
  props: {
    data: {
      type: Array,
      default: () => [],
    },
    mapType: {
      type: String,
      default: "china",
    },
  },

  computed: {
    mapOption() {
      const zoom = 1.2;

      const color = [
        "#6bcc75",
        "#65c78b",
        "#5fc2a0",
        "#5abead",
        "#52b9c7",
        "#4fb6d2",
        "#4ab2e5",
        "#52b9c7",
        "#5abead",
        "#dfae10",
        "#d5b314",
        "#c1bb1f",
        "#f34e2b",
        "#f56321",
        "#f56f1c",
        "#4ab2e5",
        "#4fb6d2",
        "#f58414",
        "#f58f0e",
        "#f5a305",
        "#e7ab0b",
        "#b9be23",
        "#e7ab0b",
        "#dfae10",
        "#d5b314",
        "#c1bb1f",
        "#b9be23",
        "#a6c62c",
        "#96cc34",
        "#89d23b",
        "#7ed741",
        "#77d64c",
        "#71d162",
      ];
      const chinaPoints = [
        {
          value: [118.8062, 31.9208],
        },
        {
          value: [127.9688, 45.368],
        },
        {
          value: [110.3467, 41.4899],
        },
        {
          value: [125.8154, 44.2584],
        },
        {
          value: [116.4551, 40.2539],
        },
        {
          value: [106.504962, 29.533155],
        },
        {
          value: [114.4995, 38.1006],
        },
        {
          value: [117.4219, 39.4189],
        },
        {
          value: [112.3352, 37.9413],
        },
        {
          value: [109.1162, 34.2004],
        },
        {
          value: [103.5901, 36.3043],
        },
        {
          value: [106.3586, 38.1775],
        },
        {
          value: [101.4038, 36.8207],
        },
        {
          value: [103.9526, 30.7617],
        },
        {
          value: [108.384366, 30.439702],
        },
        {
          value: [113.0823, 28.2568],
        },
        {
          value: [102.9199, 25.46639],
        },
        {
          value: [119.4543, 25.9222],
        },
        {
          value: [91.11, 29.97],
        },
        {
          value: [87.68, 43.77],
        },
      ];
      const worldPoints = [
        {
          value: [67.709953, 33.93911],
        },
        {
          value: [17.873887, -11.202692],
        },
        {
          value: [20.168331, 41.153332],
        },
        {
          value: [53.847818, 23.424076],
        },
        {
          value: [-63.61667199999999, -38.416097],
        },
        {
          value: [45.038189, 40.069099],
        },
        {
          value: [69.348557, -49.280366],
        },
        {
          value: [133.775136, -25.274398],
        },
        {
          value: [14.550072, 47.516231],
        },
        {
          value: [47.576927, 40.143105],
        },
        {
          value: [29.918886, -3.373056],
        },
        {
          value: [4.469936, 50.503887],
        },
        {
          value: [2.315834, 9.30769],
        },
        {
          value: [-1.561593, 12.238333],
        },
        {
          value: [90.356331, 23.684994],
        },
        {
          value: [25.48583, 42.733883],
        },
        {
          value: [-77.39627999999999, 25.03428],
        },
        {
          value: [17.679076, 43.915886],
        },
        {
          value: [27.953389, 53.709807],
        },
        {
          value: [-88.49765, 17.189877],
        },
        {
          value: [-64.7505, 32.3078],
        },
        {
          value: [-63.58865299999999, -16.290154],
        },
        {
          value: [-51.92528, -14.235004],
        },
        {
          value: [114.727669, 4.535277],
        },
        {
          value: [90.433601, 27.514162],
        },
        {
          value: [24.684866, -22.328474],
        },
        {
          value: [20.939444, 6.611110999999999],
        },
        {
          value: [-106.346771, 56.130366],
        },
        {
          value: [8.227511999999999, 46.818188],
        },
        {
          value: [-71.542969, -35.675147],
        },
        {
          value: [104.195397, 35.86166],
        },
        {
          value: [-5.547079999999999, 7.539988999999999],
        },
        {
          value: [12.354722, 7.369721999999999],
        },
        {
          value: [21.758664, -4.038333],
        },
        {
          value: [15.827659, -0.228021],
        },
        {
          value: [-74.297333, 4.570868],
        },
        {
          value: [-83.753428, 9.748916999999999],
        },
        {
          value: [-77.781167, 21.521757],
        },
        {
          value: [33.429859, 35.126413],
        },
        {
          value: [33.429859, 35.126413],
        },
        {
          value: [15.472962, 49.81749199999999],
        },
        {
          value: [10.451526, 51.165691],
        },
        {
          value: [42.590275, 11.825138],
        },
        {
          value: [9.501785, 56.26392],
        },
        {
          value: [-70.162651, 18.735693],
        },
        {
          value: [1.659626, 28.033886],
        },
        {
          value: [-78.18340599999999, -1.831239],
        },
        {
          value: [30.802498, 26.820553],
        },
        {
          value: [39.782334, 15.179384],
        },
        {
          value: [-3.74922, 40.46366700000001],
        },
        {
          value: [25.013607, 58.595272],
        },
        {
          value: [40.489673, 9.145000000000001],
        },
        {
          value: [25.748151, 61.92410999999999],
        },
        {
          value: [178.065032, -17.713371],
        },
        {
          value: [-59.523613, -51.796253],
        },
        {
          value: [2.213749, 46.227638],
        },
        {
          value: [11.609444, -0.803689],
        },
        {
          value: [-3.435973, 55.378051],
        },
        {
          value: [-82.9000751, 32.1656221],
        },
        {
          value: [-1.023194, 7.946527],
        },
        {
          value: [-9.696645, 9.945587],
        },
        {
          value: [-15.310139, 13.443182],
        },
        {
          value: [-15.180413, 11.803749],
        },
        {
          value: [10.267895, 1.650801],
        },
        {
          value: [21.824312, 39.074208],
        },
        {
          value: [-42.604303, 71.706936],
        },
        {
          value: [-90.23075899999999, 15.783471],
        },
        {
          value: [-53.125782, 3.933889],
        },
        {
          value: [-58.93018, 4.860416],
        },
        {
          value: [-86.241905, 15.199999],
        },
        {
          value: [15.2, 45.1],
        },
        {
          value: [-72.285215, 18.971187],
        },
        {
          value: [19.503304, 47.162494],
        },
        {
          value: [113.921327, -0.789275],
        },
        {
          value: [-8.24389, 53.41291],
        },
        {
          value: [53.688046, 32.427908],
        },
        {
          value: [43.679291, 33.223191],
        },
        {
          value: [-19.020835, 64.963051],
        },
        {
          value: [34.851612, 31.046051],
        },
        {
          value: [12.56738, 41.87194],
        },
        {
          value: [-77.297508, 18.109581],
        },
        {
          value: [36.238414, 30.585164],
        },
        {
          value: [138.252924, 36.204824],
        },
        {
          value: [66.923684, 48.019573],
        },
        {
          value: [37.906193, -0.023559],
        },
        {
          value: [74.766098, 41.20438],
        },
        {
          value: [104.990963, 12.565679],
        },
        {
          value: [127.766922, 35.907757],
        },
        {
          value: [20.902977, 42.6026359],
        },
        {
          value: [47.481766, 29.31166],
        },
        {
          value: [102.495496, 19.85627],
        },
        {
          value: [35.862285, 33.854721],
        },
        {
          value: [-9.429499000000002, 6.428055],
        },
        {
          value: [17.228331, 26.3351],
        },
        {
          value: [80.77179699999999, 7.873053999999999],
        },
        {
          value: [28.233608, -29.609988],
        },
        {
          value: [23.881275, 55.169438],
        },
        {
          value: [6.129582999999999, 49.815273],
        },
        {
          value: [24.603189, 56.879635],
        },
        {
          value: [-7.092619999999999, 31.791702],
        },
        {
          value: [28.369885, 47.411631],
        },
        {
          value: [46.869107, -18.766947],
        },
        {
          value: [-102.552784, 23.634501],
        },
        {
          value: [21.745275, 41.608635],
        },
        {
          value: [-3.996166, 17.570692],
        },
        {
          value: [95.956223, 21.913965],
        },
        {
          value: [19.37439, 42.708678],
        },
        {
          value: [103.846656, 46.862496],
        },
        {
          value: [35.529562, -18.665695],
        },
        {
          value: [-10.940835, 21.00789],
        },
        {
          value: [34.301525, -13.254308],
        },
        {
          value: [101.975766, 4.210484],
        },
        {
          value: [18.49041, -22.95764],
        },
        {
          value: [165.618042, -20.904305],
        },
        {
          value: [8.081666, 17.607789],
        },
        {
          value: [8.675277, 9.081999],
        },
        {
          value: [-85.207229, 12.865416],
        },
        {
          value: [5.291265999999999, 52.132633],
        },
        {
          value: [8.468945999999999, 60.47202399999999],
        },
        {
          value: [84.12400799999999, 28.394857],
        },
        {
          value: [174.885971, -40.900557],
        },
        {
          value: [55.923255, 21.512583],
        },
        {
          value: [69.34511599999999, 30.375321],
        },
        {
          value: [-80.782127, 8.537981],
        },
        {
          value: [-75.015152, -9.189967],
        },
        {
          value: [121.774017, 12.879721],
        },
        {
          value: [143.95555, -6.314992999999999],
        },
        {
          value: [19.145136, 51.919438],
        },
        {
          value: [-66.590149, 18.220833],
        },
        {
          value: [127.510093, 40.339852],
        },
        {
          value: [-8.224454, 39.39987199999999],
        },
        {
          value: [-58.443832, -23.442503],
        },
        {
          value: [51.183884, 25.354826],
        },
        {
          value: [24.96676, 45.943161],
        },
        {
          value: [105.318756, 61.52401],
        },
        {
          value: [29.873888, -1.940278],
        },
        {
          value: [-12.885834, 24.215527],
        },
        {
          value: [45.079162, 23.885942],
        },
        {
          value: [30.217636, 12.862807],
        },
        {
          value: [31.3069788, 6.876991899999999],
        },
        {
          value: [-14.452362, 14.497401],
        },
        {
          value: [160.156194, -9.64571],
        },
        {
          value: [-11.779889, 8.460555],
        },
        {
          value: [-88.89653, 13.794185],
        },
        {
          value: [46.8252838, 9.411743399999999],
        },
        {
          value: [46.199616, 5.152149],
        },
        {
          value: [21.005859, 44.016521],
        },
        {
          value: [-56.027783, 3.919305],
        },
        {
          value: [19.699024, 48.669026],
        },
        {
          value: [14.995463, 46.151241],
        },
        {
          value: [18.643501, 60.12816100000001],
        },
        {
          value: [31.465866, -26.522503],
        },
        {
          value: [38.996815, 34.80207499999999],
        },
        {
          value: [18.732207, 15.454166],
        },
        {
          value: [0.824782, 8.619543],
        },
        {
          value: [100.992541, 15.870032],
        },
        {
          value: [71.276093, 38.861034],
        },
        {
          value: [59.556278, 38.969719],
        },
        {
          value: [125.727539, -8.874217],
        },
        {
          value: [-61.222503, 10.691803],
        },
        {
          value: [9.537499, 33.886917],
        },
        {
          value: [35.243322, 38.963745],
        },
        {
          value: [34.888822, -6.369028],
        },
        {
          value: [32.290275, 1.373333],
        },
        {
          value: [31.16558, 48.379433],
        },
        {
          value: [-55.765835, -32.522779],
        },
        {
          value: [-95.712891, 37.09024],
        },
        {
          value: [64.585262, 41.377491],
        },
        {
          value: [-66.58973, 6.42375],
        },
        {
          value: [108.277199, 14.058324],
        },
        {
          value: [166.959158, -15.376706],
        },
        {
          value: [35.3027226, 31.9465703],
        },
        {
          value: [48.516388, 15.552727],
        },
        {
          value: [22.937506, -30.559482],
        },
        {
          value: [27.849332, -13.133897],
        },
        {
          value: [29.154857, -19.015438],
        },
        {
          value: [43.872219, -11.875001],
        },
        {
          value: [106.515414, -6.10304],
        },
        {
          value: [78.96288, 20.593684],
        },
      ];

      let points =
        this.mapType == "china"
          ? chinaPoints.sort(() => Math.random() - 0.5).slice(0, 15)
          : worldPoints.sort(() => Math.random() - 0.5).slice(0, 20);

      const option = {
        // backgroundColor: "#013954",
        geo: {
          map: this.mapType,
          zoom,
          roam: false,
          itemStyle: {
            normal: {
              areaColor: {
                type: "radial",
                x: 0.5,
                y: 0.5,
                r: 0.8,
                colorStops: [
                  {
                    offset: 0,
                    color: "#09132c", // 0% 处的颜色
                  },
                  {
                    offset: 1,
                    color: "#274d68", // 100% 处的颜色
                  },
                ],
                globalCoord: true, // 缺省为 false
              },
              shadowColor: "rgb(58,115,192)",
              shadowOffsetX: 10,
              shadowOffsetY: 11,
            },
            emphasis: {
              areaColor: "#2AB8FF",
              borderWidth: 0,
              color: "green",
              label: {
                show: false,
              },
            },
          },

          regions: [
            {
              name: "南海诸岛",
              itemStyle: {
                areaColor: "rgba(0, 10, 52, 1)",
                borderColor: "rgba(0, 10, 52, 1)",
                normal: {
                  opacity: 0,
                  label: {
                    show: false,
                    color: "#009cc9",
                  },
                },
              },
            },
          ],
        },
        color: color,
        series: [
          {
            type: "map",
            roam: false,
            itemStyle: {
              normal: {
                borderColor: "rgb(147, 235, 248)",
                borderWidth: 1,
                areaColor: {
                  type: "radial",
                  x: 0.5,
                  y: 0.5,
                  r: 0.8,
                  colorStops: [
                    {
                      offset: 0,
                      color: "#09132c", // 0% 处的颜色
                    },
                    {
                      offset: 1,
                      color: "#274d68", // 100% 处的颜色
                    },
                  ],
                  globalCoord: true, // 缺省为 false
                },
              },
              emphasis: {
                areaColor: "#c56261",
              },
            },
            zoom,
            map: this.mapType, //使用
            data: [
              {
                name: this.mapType == "world" ? "China" : "重庆",
                selected: true,
              },
            ],
          },
          {
            type: "effectScatter",
            coordinateSystem: "geo",
            showEffectOn: "render",
            zlevel: 1,
            rippleEffect: {
              period: 15,
              scale: 4,
              brushType: "fill",
            },
            hoverAnimation: true,
            label: {
              normal: {
                formatter: "{b}",
                position: "right",
                offset: [15, 0],
                color: "#1DE9B6",
                show: true,
              },
            },
            itemStyle: {
              normal: {
                color: function (i) {
                  return color[i.dataIndex];
                },
                shadowBlur: 10,
                shadowColor: "#333",
              },
            },
            symbolSize: 12,
            data: points,
          },
          {
            type: "lines",
            zlevel: 2,
            effect: {
              show: true,
              period: 4, //箭头指向速度，值越小速度越快
              trailLength: 0.4, //特效尾迹长度[0,1]值越大，尾迹越长重
              symbol: "arrow", //箭头图标
              symbolSize: 7, //图标大小
            },
            lineStyle: {
              normal: {
                color: function (i) {
                  return color[i.dataIndex];
                },
                width: 1, //线条宽度
                opacity: 0.1, //尾迹线条透明度
                curveness: 0.3, //尾迹线条曲直度
              },
            },
            data:
              // this.data.map(item=>(
              //                   {
              //     coords: [
              //       [item.slon, item.slat],
              //       [item.dlon, item.dlat],
              //     ],
              //   }
              // ))
              points.map((item) => ({
                coords: [item.value, [106.504962, 29.533155]],
              })),
          },
        ],
      };
      return option;
    },
  },
};
</script>

<style>
</style>